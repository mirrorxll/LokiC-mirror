(()=>{
    let fcd_body = document.getElementById('fcd_body').innerHTML;
    let reviewersFeedback = document.getElementById('reviewers_feedback_body').innerHTML

    document.getElementById('manual_feedback_modal_label').innerText = `<%= "FCD ##{@story_type.id} #{@story_type.name} -- #{@story_type.developer.name} -- reviewers feedback".html_safe %>`
    document.querySelector('#manual_feedback_modal #fcd').innerHTML = fcd_body;
    $('#manual_feedback_modal .w-39').html(`<%= j render 'form' %>`);
    document.querySelector('#reviewers_feedback_body_modal').innerHTML = reviewersFeedback;

    let allFcdLinks = document.querySelectorAll('#manual_feedback_modal #fcd a')
    allFcdLinks.forEach(function(a) {
        a.setAttribute('target', '_blank')
    });

    let samples =
        <% if Rails.env.production? %>
          document.querySelectorAll('#manual_feedback_modal #fcd a[href^="https://lokic.locallabs.com/story_types/"][href*="/iterations/"][href*="/samples/"]')
        <% else %>
          document.querySelectorAll('#manual_feedback_modal #fcd a[href^="http://localhost:3000/story_types/"][href*="/iterations/"][href*="/samples/"]')
        <% end %>

    samples.forEach(function(a) {
       a.removeAttribute('target');
       a.setAttribute('data-remote', 'true')
    });

    $('#manual_feedback_modal').off('hidden.bs.modal')
}).call();
