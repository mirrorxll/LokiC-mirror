=render 'channel'

%div{ id: "story_type_show_#{@story_type.id}"}
%hr
#story_type_name
  %b #{@story_type.name}
%hr
#story_type_template.accordion
  .card
    .card-header
      %div.text-center{"aria-controls" => "#template", "aria-expanded" => "true", "data-target" => "#template", "data-toggle" => "collapse", :type => "button"}
        template
    #template.collapse.show{"data-parent" => "#story_type_template"}
      .card-body.small
        =render 'story_types/show_template'

#story_type_properties.accordion
  .card
    .card-header
      %div.text-center{"aria-controls" => "#properties", "aria-expanded" => "false", "data-target" => "#properties", "data-toggle" => "collapse", :type => "button"}
        properties
    #properties.collapse.show{"data-parent" => "#story_type_properties"}
      .card-body
        =render 'story_types/properties'

#story_type_staging_table.accordion
  .card
    .card-header
      %div.text-center{"aria-controls" => "#staging_table", "aria-expanded" => "false", "data-target" => "#staging_table", "data-toggle" => "collapse", :type => "button"}
        staging table
    #staging_table.collapse.show{"data-parent" => "#story_type_staging_table"}
      .card-body
        -if @story_type.staging_table
          =render @story_type.staging_table
        -else
          =render 'staging_tables/form'

#story_type_code.accordion
  .card
    .card-header
      %div.text-center{"aria-controls" => "#codes", "aria-expanded" => "false", "data-target" => "#codes", "data-toggle" => "collapse", :type => "button"}
        code
    #code.collapse.show{"data-parent" => "#story_type_code"}
      .card-body
        -if @story_type.code.attached?
          =render 'codes/story_type_code'
        -else
          =render 'codes/form'

#story_type_export_configs__samples.accordion
  .card
    .card-header
      %div.text-center{"aria-controls" => "#samles", "aria-expanded" => "false", "data-target" => "#samples", "data-toggle" => "collapse", :type => "button"}
        export configurations / samples
    #samples.collapse.show{"data-parent" => "#story_type_export_configs__samples"}
      .card-body
        =render 'export_configurations/export_configs'
        =render 'samples/samples'

#story_type_scheduler.accordion
  .card
    .card-header
      %div.text-center{"aria-controls" => "#scheduler", "aria-expanded" => "false", "data-target" => "#scheduler", "data-toggle" => "collapse", :type => "button"}
        scheduler
    #scheduler.collapse.show{"data-parent" => "#story_type_scheduler"}
      .card-body
        -if @story_type.iterations.last.schedule
          .row
            .col-12
              #results_scheduling
                =render 'schedules/results_scheduling'
        -else
          .row
            .col-6
              #manual_scheduler
                =render 'schedules/form_manual'
            .col-6
              #auto_scheduler
                =render 'schedules/form_auto'
          -unless @story_type.iterations.last.samples.where.not(published_at: nil).empty?
            .row
              .col-6
                #backdate_scheduler
                  =render 'schedules/form_backdate'
                  =render 'schedules/set_dates'
              .col-6
                =render 'schedules/results_scheduling'

#story_type_export.accordion
  .card
    .card-header
      %div.text-center{"aria-controls" => "#export", "aria-expanded" => "false", "data-target" => "#export", "data-toggle" => "collapse", :type => "button"}
        export
    #export.collapse.show{"data-parent" => "#story_type_export"}
      .card-body
        -if @story_type.staging_table && @story_type.iteration.creation
          .row
            .col-11.offset-1
              .btn-group.mr-5
                =link_to('export!',
                          staging_story_type_exports_path(@story_type),
                          class: 'btn btn-sm btn-outline-dark', method: :post, remote: true)
