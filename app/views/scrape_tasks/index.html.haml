.container-fluid.pt-5
  %hr/
  #header.d-flex.justify-content-between.align-items-center.row.mt-3
    #total.col-8
      Total:
      =@scrape_tasks_grid.assets.total_count
    .buttons.col-4.text-right
      =link_to('filter', '#filter', 'aria-controls' => 'scrape_task_filter',
               'aria-expanded' => false, data: { toggle: "collapse", target: "#filter" },
               type: "button", class: 'btn btn-sm btn-outline-dark mr-2')
      -if current_account.types.include?('manager')
        %button.btn.btn-sm.btn-outline-dark{'data-target' => '#newScrapeTaskModal', 'data-toggle' => 'modal', type: "button"}
          new scrape task
  %hr/

  #filter.mt-3.mb-3.collapse{ class: (params[:scrape_tasks_grid] ? 'show' : '') }
    =datagrid_form_for @scrape_tasks_grid, url: scrape_tasks_path

  .row.small.mb-5
    .col-12
      =datagrid_table(@scrape_tasks_grid)

  =render 'scrape_tasks/new_form'

.fixed-bottom.bg-light
  .row.mt-2
    .col-12
      =paginate @scrape_tasks_grid.assets

:javascript
  document.querySelector('.navbar').classList.add('fixed-top');

  $('#filter').on('show.bs.collapse', () => {
    sessionStorage['filter_show'] = true;
  });

  $('#filter').on('hide.bs.collapse', () => {
    sessionStorage['filter_show'] = false;
  });

  (() => {
    let filterClasses = document.querySelector('#filter').classList;

    if(JSON.parse(sessionStorage['filter_show'])) {
      filterClasses.add('show');
    } else {
      filterClasses.remove('show');
    }
  })();