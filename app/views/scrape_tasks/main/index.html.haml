%hr/
#header.d-flex.justify-content-between.align-items-center.mt-3
  %span
    -if @current_list
      Total: #{@grid.assets.total_count}
  %span.font-weight-bold
    SCRAPE TASKS
  .d-inline-block.text-right.text-uppercase
    .btn-group.mr-3
      -if @current_list && @lists.length > 1
        -@lists.each_key do |list|
          -filled = @current_list.eql?(list) ? '' : '-outline'
          =link_to(list, url_for(list: list), class: "btn btn-sm btn#{filled}-dark")
    .btn-group
      -if @current_list
        =link_to('filter', '#', class: 'btn btn-sm btn-outline-dark',
                 "data-target" => "#filter", "data-toggle" => "collapse")
      -if @permissions['new_form']
        =link_to('create', '#', class: 'btn btn-sm btn-outline-dark',
                 "data-target" => "#createScrapeTaskModal", "data-toggle" => "modal")
%hr/

-if @current_list
  #filter.mt-3.mb-3.collapse{ class: (params[:scrape_tasks_grid] ? 'show' : '') }
    =datagrid_form_for @grid, url: scrape_tasks_path

  .row.small.mb-5
    .col-12
      =datagrid_table(@grid)

  .fixed-bottom.bg-light
    .row
      .col-12.p-2
        =paginate @grid.assets

  :javascript
    (() => {
      let filter = $('#filter');
      filter.on('show.bs.collapse', () => {
        sessionStorage['filter_show'] = true;
      });

      filter.on('hide.bs.collapse', () => {
        sessionStorage['filter_show'] = false;
      });

      if(JSON.parse(sessionStorage['filter_show'])) {
        filter.addClass('show');
      } else {
        filter.removeClass('show');
      }
    })();

-if @permissions['new_form']
  =render 'scrape_tasks/main/new_form'
