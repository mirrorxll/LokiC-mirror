=form_with(url: tasks_path, id: 'form_new_task') do |form|
  .row.small
    .col
      .form-group
        =form.text_field 'task[title]', placeholder: 'title', class: 'form-control', required: true
      .form-group
        =form.text_area 'task[description]', class: 'form-control', data: { editor: 'summernote' }
      .form-group.row
        .col-2
          =form.label 'assignment to'
        .col-10.row.text-left
          #assignments
            =form.collection_select "task[assignment_to][]", Account.all.order([:first_name, :last_name]), :id, :name, { prompt: '', class: 'form-control' }
          #add_assignment.ml-2
            =icon('fas', 'plus')
  .row.small
    .col
      =form.submit :create, class: 'btn btn-sm btn-outline-dark'

:javascript
  var accounts = #{raw Account.all.order([:first_name, :last_name]).map{ |account| [account.first_name, account.last_name]} };

  $('#add_assignment').click(function () {

    $('#assignments').append(
        `<select id="task[assignment_to][]" name="task[assignment_to][]" class="mr-2 ml-2">${buildSelect(accounts)}</select>`
    );
  });

  function buildSelect(options) {
    var $select = $('');
    $select += ('<option value="' + '' + '">' + '' + '</option>');
    for (var i = 0; i < options.length; i++) {
      $select += ('<option value="' + options[i] + '">' + options[i] + '</option>');
    }
    return $select;
  }


