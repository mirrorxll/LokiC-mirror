=form_with(url: task_path(@task), method: :patch, html: { onkeypress: "return event.keyCode !== 13;" }) do |form|
  .row.small
    .col
      .form-group
        =form.text_field 'task[title]', placeholder: 'title', class: 'form-control', required: true, value: @task.title, maxlength: 500
      .form-group
        =form.text_area 'task[description]', id: 'task_description', value: @task.description
  %hr/
  .form-group.row.small.font-weight-bold.text-center.justify-content-between
    .col
      reminder frequency:
    .col
      client:
    .col
      deadline:
    .col
      gather_task:
    .col
      =form.check_box 'task[access]', class: 'form-check-input', checked: @task.access
      %label.form-check-label
        Access to tasks and its subtasks
    .col
      main_task
  .form-group.row.small.text-center.justify-content-between
    .col
      =form.collection_select 'task[reminder_frequency]', sorted_reminder_frequencies, :id, :name, { selected: @task.reminder_frequency.nil? ? '' : @task.reminder_frequency.id, prompt: '' }
    .col
      =form.collection_select 'task[client_id]', ClientsReport.all.order(:name), :id, :name, { selected: @task.client.nil? ? '' : @task.client.id, prompt: '' }, style: "width:150px"
    .col
      =form.date_field 'task[deadline]', value: @task.deadline
    .col
      =form.text_field 'task[gather_task]', value: @task.gather_task
    .col
      =form.collection_select 'task[parent]', Task.where(parent: nil).where.not(status: Status.find_by(name: 'deleted')).order(:id) - [@task], :id, :title_with_id, { selected: @task.parent.nil? ? '' : @task.parent.id, prompt: '' }, style: "width:150px"
  %hr/
  .modal-footer
    =link_to( 'close', '#', class: 'ml-auto btn btn-sm btn-outline-secondary',
              'data-dismiss' => 'modal')
    =form.submit 'save changes', class: 'mr-auto btn btn-sm btn-outline-success'

:javascript
  $('#task').on('hidden.bs.modal', function () {
    $('#task .modal-body').empty();
  });
