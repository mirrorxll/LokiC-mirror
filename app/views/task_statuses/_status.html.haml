.current_progress_status
  =link_to(task.status.name, '#',
        class: "badge badge-pill badge-#{status_color(task.status.name)}")

.change_progress_status_form.d-none
  =form_with(url: change_task_progress_statuses_path(task), id: 'status_form',
             html: { class: 'd-inline', onchange: "statusSubmit();" }, method: :patch) do |form|
    =form.collection_select :status_id, Status.multi_task_dev_statuses, :id, :name, { prompt: '' , selected: task.status.id},
    data: { confirm: 'Are you sure you want to delete the task?' }

:javascript
  document.querySelector('.current_progress_status a').addEventListener('click', function (evt) {
    var clickable = #{!task.assignment_to.empty? && (current_account.types.include?('manager') || current_account.in?(task.assignment_to))};
    if (!clickable) return;

    evt.preventDefault();
    evt.target.parentNode.classList.add('d-none');
    document.getElementsByClassName('change_progress_status_form')[0].classList.remove('d-none');
    return false;
  });

  function statusSubmit() {
    var select = document.getElementById('status_id');
    var status = select.options[select.selectedIndex].text;
    console.log(status);
    if(status == 'deleted'){
      message = confirm("Are you sure you want to delete the task?");
      if (!message) return;
    }
    if (['blocked', 'canceled'].includes(status)) {
      Rails.ajax({
      type: "GET",
      dataType: 'script',
      url: `#{new_task_comment_path(task)}`,
      data: `subtype=status comment`
      })
    }
    document.getElementById('status_form').submit;
  };
