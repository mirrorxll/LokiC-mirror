#workRequestStatusComment
  =render 'status_comment'

-if static
  =form_with(url: api_work_request_path(@work_request), method: :patch, html: { id: 'managerForm'}) do |f|
    .row.mb-4.align-items-center.text
      .col-3.pr-0.text-right.font-weight-bold
        BILLED FOR ENTIRE PROJECT?
      .col-9
        =f.radio_button "work_request[billed_for_entire_project?]", true, checked: @work_request.billed_for_entire_project?
        =f.label "work_request[billed_for_entire_project]", 'yes', value: true, class: 'mr-3 mb-0'
        =f.radio_button "work_request[billed_for_entire_project?]", false, checked: @work_request.billed_for_entire_project?.eql?(false)
        =f.label "work_request[billed_for_entire_project]", 'no', value: false, class: 'mb-0'
    .row.mb-1.align-items-center
      .col-3.pr-0.text-right.font-weight-bold
        ETA:
      .col-9
        =f.date_field "work_request[eta]", class: 'form-control form-control-sm w-150px', value: @work_request.eta
  %hr/

  :javascript
    document.querySelector('#managerForm').addEventListener('input', delay(() => {
      Rails.fire(document.querySelector('#managerForm'), 'submit');
    }, 500), false)

    function delay(fn, ms) {
      let timer = 0;
      return function(...args) {
        clearTimeout(timer);
        timer = setTimeout(fn.bind(this, ...args), ms || 0)
      }
    }

.row.mb-1
  .col-3.pr-0.text-right.font-weight-bold
    CLIENTS:
  .col-9
    -@work_request.clients.each do |cl|
      =cl.name
      %br/
.row.mb-1.text-break
  .col-3.pr-0.text-right.font-weight-bold
    DETAILS:
  .col-9
    =@work_request.project_order_details.body&.gsub(/\n/, '<br/>')&.html_safe
.row.mb-1.text-break
  .col-3.pr-0.text-right.font-weight-bold
    MOST WORRIED DETAILS:
  .col-9
    =@work_request.most_worried_details.body&.gsub(/\n/, '<br/>')&.html_safe
.row.mb-1.align-items-end
  .col-3.pr-0.text-right.font-weight-bold
    GOAL DEADLINE:
  .col-9
    =@work_request.goal_deadline
.row.mb-1.align-items-end
  .col-3.pr-0.text-right.font-weight-bold
    FINALE DEADLINE:
  .col-9
    =@work_request.final_deadline
.row.mb-1.align-items-end
  .col-3.pr-0.text-right.font-weight-bold
    LAST INVOICE DATE:
  .col-9
    =@work_request.last_invoice
.row.mb-1.align-items-end
  .col-3.pr-0.text-right.font-weight-bold
    ETA:
  .col-9
    =@work_request.eta
.row.mb-1.align-items-end
  .col-3.pr-0.text-right.font-weight-bold
    PRIORITY:
  .col-9
    =@work_request.priority.name
